WARNING:tensorflow:From /home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
WARNING:tensorflow:From /home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
/home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/tensorflow/python/ops/gradients_impl.py:110: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
Model: "graphmodel_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
atom (InputLayer)               (None, 1)            0
__________________________________________________________________________________________________
squeeze_1 (Squeeze)             (None,)              0           atom_index[0][0]
                                                                 atom[0][0]
                                                                 n_pro[0][0]
__________________________________________________________________________________________________
atom_embedding (Embedding)      (None, 256)          2560        squeeze_1[1][0]
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 256)          65536       atom_embedding[0][0]
__________________________________________________________________________________________________
connectivity (InputLayer)       (None, 2)            0
__________________________________________________________________________________________________
gather_atom_to_bond_1 (GatherAt (None, 256)          0           dense_1[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
gather_atom_to_bond_2 (GatherAt (None, 256)          0           dense_1[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
distance_rbf (InputLayer)       (None, 256)          0
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 768)          0           gather_atom_to_bond_1[0][0]
                                                                 gather_atom_to_bond_2[0][0]
                                                                 distance_rbf[0][0]
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          393728      concatenate_1[0][0]
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 256)          65792       dense_3[0][0]
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 256)          65792       dense_4[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 256)          0           dense_5[0][0]
                                                                 distance_rbf[0][0]
__________________________________________________________________________________________________
multiply_1 (Multiply)           (None, 256)          0           gather_atom_to_bond_1[0][0]
                                                                 add_1[0][0]
__________________________________________________________________________________________________
reduce_bond_to_atom_1 (ReduceBo (None, 256)          0           multiply_1[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 256)          65792       reduce_bond_to_atom_1[0][0]
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 256)          65792       dense_6[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 256)          0           dense_1[0][0]
                                                                 dense_7[0][0]
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 256)          65536       add_2[0][0]
__________________________________________________________________________________________________
gather_atom_to_bond_3 (GatherAt (None, 256)          0           dense_8[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
gather_atom_to_bond_4 (GatherAt (None, 256)          0           dense_8[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 768)          0           gather_atom_to_bond_3[0][0]
                                                                 gather_atom_to_bond_4[0][0]
                                                                 add_1[0][0]
__________________________________________________________________________________________________
dense_9 (Dense)                 (None, 512)          393728      concatenate_2[0][0]
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 256)          131328      dense_9[0][0]
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 256)          65792       dense_10[0][0]
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 256)          65792       dense_11[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 256)          0           dense_12[0][0]
                                                                 add_1[0][0]
__________________________________________________________________________________________________
multiply_2 (Multiply)           (None, 256)          0           gather_atom_to_bond_3[0][0]
                                                                 add_3[0][0]
__________________________________________________________________________________________________
reduce_bond_to_atom_2 (ReduceBo (None, 256)          0           multiply_2[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
dense_13 (Dense)                (None, 256)          65792       reduce_bond_to_atom_2[0][0]
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 256)          65792       dense_13[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 256)          0           dense_8[0][0]
                                                                 dense_14[0][0]
__________________________________________________________________________________________________
dense_15 (Dense)                (None, 256)          65536       add_4[0][0]
__________________________________________________________________________________________________
gather_atom_to_bond_5 (GatherAt (None, 256)          0           dense_15[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
gather_atom_to_bond_6 (GatherAt (None, 256)          0           dense_15[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 768)          0           gather_atom_to_bond_5[0][0]
                                                                 gather_atom_to_bond_6[0][0]
                                                                 add_3[0][0]
__________________________________________________________________________________________________
dense_16 (Dense)                (None, 512)          393728      concatenate_3[0][0]
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 256)          131328      dense_16[0][0]
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 256)          65792       dense_17[0][0]
__________________________________________________________________________________________________
dense_19 (Dense)                (None, 256)          65792       dense_18[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 256)          0           dense_19[0][0]
                                                                 add_3[0][0]
__________________________________________________________________________________________________
multiply_3 (Multiply)           (None, 256)          0           gather_atom_to_bond_5[0][0]
                                                                 add_5[0][0]
__________________________________________________________________________________________________
reduce_bond_to_atom_3 (ReduceBo (None, 256)          0           multiply_3[0][0]
                                                                 connectivity[0][0]
__________________________________________________________________________________________________
dense_20 (Dense)                (None, 256)          65792       reduce_bond_to_atom_3[0][0]
__________________________________________________________________________________________________
dense_21 (Dense)                (None, 256)          65792       dense_20[0][0]
__________________________________________________________________________________________________
atom_index (InputLayer)         (None, 1)            0
__________________________________________________________________________________________________
n_pro (InputLayer)              (None, 1)            0
__________________________________________________________________________________________________
add_6 (Add)                     (None, 256)          0           dense_15[0][0]
                                                                 dense_21[0][0]
__________________________________________________________________________________________________
reduce_atom_to_pro_1 (ReduceAto (None, 256)          0           add_6[0][0]
                                                                 squeeze_1[0][0]
                                                                 squeeze_1[2][0]
__________________________________________________________________________________________________
dense_22 (Dense)                (None, 256)          65792       reduce_atom_to_pro_1[0][0]
__________________________________________________________________________________________________
dense_23 (Dense)                (None, 256)          65792       dense_22[0][0]
__________________________________________________________________________________________________
dense_24 (Dense)                (None, 128)          32896       dense_23[0][0]
__________________________________________________________________________________________________
atomwise_shift (Embedding)      (None, 1)            10          squeeze_1[1][0]
__________________________________________________________________________________________________
dense_25 (Dense)                (None, 1)            129         dense_24[0][0]
__________________________________________________________________________________________________
reduce_atom_to_pro_2 (ReduceAto (None, 1)            0           atomwise_shift[0][0]
                                                                 squeeze_1[0][0]
                                                                 squeeze_1[2][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 1)            0           dense_25[0][0]
                                                                 reduce_atom_to_pro_2[0][0]
==================================================================================================
Total params: 2,728,459
Trainable params: 2,728,459
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/1200



































































































































































































202/202 [==============================] - 496s 2s/step - loss: 112.9270 - val_loss: 1.5826
Epoch 00001: val_loss improved from inf to 1.58264, saving model to new_best_model.hdf5
Traceback (most recent call last):
  File "graph_network.py", line 220, in <module>
    callbacks=[checkpoint, csv_logger, lr_decay, WandbCallback()])
  File "/home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/keras/engine/training.py", line 1658, in fit_generator
    initial_epoch=initial_epoch)
  File "/home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/keras/engine/training_generator.py", line 255, in fit_generator
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/keras/callbacks.py", line 152, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/wandb/integration/keras/keras.py", line 630, in on_epoch_end
    self._save_model_as_artifact(epoch)
  File "/home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/wandb/integration/keras/keras.py", line 1026, in _save_model_as_artifact
    model_artifact.add_dir(self.filepath[:-3] + "/")
  File "/home/s3665828/.conda/envs/cascade/lib/python3.7/site-packages/wandb/sdk/artifacts/artifact.py", line 1230, in add_dir
    raise ValueError("Path is not a directory: %s" % local_path)
ValueError: Path is not a directory: /home/s3665828/Documents/Masters_Thesis/repo/CASCADE/code/predicting_model/H/DFTNN/wandb/run-20240118_152617-4twpmy2d/files/model-best/